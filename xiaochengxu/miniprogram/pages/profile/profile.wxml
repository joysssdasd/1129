<view class="container">
  <!-- 头部区域 -->
  <view class="profile-header">
    <block wx:if="{{isLoggedIn}}">
      <view class="user-info-section">
        <view class="avatar-large">
          <text class="avatar-text-large">{{userInfo.phone ? userInfo.phone.slice(-4) : 'User'}}</text>
        </view>
        <view class="user-details">
          <view class="user-name">{{userInfo.phone || '微信用户'}}</view>
          <view class="user-id">ID: {{userInfo.id || '---'}}</view>
        </view>
      </view>
      
      <view class="stats-row">
        <view class="stat-item">
          <text class="stat-num">{{userInfo.total_posts || 0}}</text>
          <text class="stat-lbl">发布</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-num">{{userInfo.total_invites || 0}}</text>
          <text class="stat-lbl">邀请</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-num">{{userInfo.points || 0}}</text>
          <text class="stat-lbl">积分</text>
        </view>
      </view>
    </block>

    <block wx:else>
      <view class="login-prompt-simple" bindtap="goLogin">
        <view class="login-avatar-placeholder"></view>
        <view class="login-text-col">
          <text class="login-title">登录 / 注册</text>
          <text class="login-subtitle">登录体验更多功能</text>
        </view>
        <view class="ios-arrow"></view>
      </view>
    </block>
  </view>

  <block wx:if="{{isLoggedIn}}">
    <!-- 资产组 -->
    <view class="ios-group">
      <view class="ios-cell">
        <view class="ios-cell-start">
          <ios-icon name="coin" size="40" color="#FF9500" />
        </view>
        <view class="ios-cell-body">可用积分</view>
        <view class="ios-cell-end">
          <text style="color: #FF9500; font-weight: 600;">{{userInfo.points || 0}}</text>
        </view>
      </view>
      <view class="ios-cell" bindtap="copyInviteCode">
        <view class="ios-cell-start">
          <ios-icon name="copy" size="40" color="#5856D6" />
        </view>
        <view class="ios-cell-body">我的邀请码</view>
        <view class="ios-cell-end">
          <text style="margin-right: 12rpx; font-family: monospace;">{{userInfo.invite_code || '---'}}</text>
          <ios-icon name="copy" size="28" color="#C7C7CC" />
        </view>
      </view>
      <button class="ios-cell share-btn" open-type="share" style="width: 100%; font-weight: normal; margin: 0; background: transparent; padding: 0; border: none; text-align: left;">
        <view class="ios-cell-start">
          <ios-icon name="share" size="40" color="#FF2D55" />
        </view>
        <view class="ios-cell-body">邀请好友</view>
        <view class="ios-cell-end">
          <text style="color: #8E8E93; font-size: 24rpx; margin-right: 8rpx;">分享得积分</text>
          <view class="ios-arrow"></view>
        </view>
      </button>
    </view>

    <!-- 常用功能组 -->
    <view class="ios-group">
      <view class="ios-cell" bindtap="goRecharge">
        <view class="ios-cell-start">
          <ios-icon name="wallet" size="40" color="#34C759" />
        </view>
        <view class="ios-cell-body">积分充值</view>
        <view class="ios-cell-end">
          <view class="ios-arrow"></view>
        </view>
      </view>
      <view class="ios-cell" bindtap="goPointsHistory">
        <view class="ios-cell-start">
          <ios-icon name="document" size="40" color="#FF3B30" />
        </view>
        <view class="ios-cell-body">积分记录</view>
        <view class="ios-cell-end">
          <view class="ios-arrow"></view>
        </view>
      </view>
      <view class="ios-cell" bindtap="goMyPosts">
        <view class="ios-cell-start">
          <ios-icon name="publish" size="40" color="#007AFF" />
        </view>
        <view class="ios-cell-body">我的发布</view>
        <view class="ios-cell-end">
          <view class="ios-arrow"></view>
        </view>
      </view>
    </view>

    <!-- 服务组 -->
    <view class="ios-group">
      <view class="ios-cell">
        <view class="ios-cell-start">
          <ios-icon name="wechat" size="40" color="#07C160" />
        </view>
        <view class="ios-cell-body">联系方式</view>
        <view class="ios-cell-end">
          <text>{{userInfo.wechat_id || userInfo.phone || '未设置'}}</text>
        </view>
      </view>
      <button class="ios-cell" open-type="contact" style="width: 100%; font-weight: normal; margin: 0;">
        <view class="ios-cell-start">
          <ios-icon name="settings" size="40" color="#8E8E93" />
        </view>
        <view class="ios-cell-body">联系客服</view>
        <view class="ios-cell-end">
          <view class="ios-arrow"></view>
        </view>
      </button>
      <view class="ios-cell" bindtap="viewAgreement">
        <view class="ios-cell-start">
          <ios-icon name="document" size="40" color="#8E8E93" />
        </view>
        <view class="ios-cell-body">用户协议</view>
        <view class="ios-cell-end">
          <view class="ios-arrow"></view>
        </view>
      </view>
    </view>

    <!-- 退出登录 -->
    <view class="ios-group" style="margin-top: 48rpx;">
      <view class="ios-cell" bindtap="logout" style="justify-content: center;">
        <text style="color: #FF3B30; font-weight: 500;">退出登录</text>
      </view>
    </view>
  </block>
</view>