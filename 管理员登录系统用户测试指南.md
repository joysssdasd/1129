# 管理员登录系统 - 用户测试指南

## 系统概述

已完成管理员专用登录系统和权限分离机制。管理员只能使用验证码登录，登录后自动进入后台管理页面。

## 测试环境

- **网站地址**: https://xxw86jrac1yl.space.minimaxi.com
- **管理员账号1**: 13011319329
- **管理员账号2**: 13800138000
- **测试用普通账号**: 13500000001 (密码: abc1234)

## 测试1：管理员登录流程

### 步骤
1. 访问登录页面：https://xxw86jrac1yl.space.minimaxi.com/login
2. 输入管理员手机号：**13011319329** 或 **13800138000**
3. 观察页面变化：
   - ✅ 页面应自动切换到验证码登录模式
   - ✅ 密码输入框消失
   - ✅ 显示黄色提示："管理员账号仅支持验证码登录"
   - ✅ 没有"使用密码登录"按钮

4. 点击"发送"按钮
5. 查收手机短信（6位数字验证码）
   - 验证码有效期：5分钟
   - 发送限制：1分钟内只能发送1次

6. 输入验证码
7. 点击"登录"按钮
8. 验证结果：
   - ✅ 登录成功提示
   - ✅ 自动跳转到 **/admin** 后台管理页面
   - ✅ 可以看到管理员功能（用户管理、信息管理、充值审核等）

### 预期结果
- 收到真实短信验证码
- 登录成功
- 自动跳转到后台管理页面
- 可正常使用所有管理员功能

## 测试2：管理员禁止密码登录

### 步骤
1. 访问登录页面
2. 输入管理员手机号：13011319329
3. 尝试查找"使用密码登录"选项

### 预期结果
- ✅ 没有"使用密码登录"按钮
- ✅ 只能看到验证码输入框
- ✅ 显示管理员专用提示

## 测试3：普通用户登录正常

### 步骤
1. 访问登录页面
2. 输入普通用户手机号：**13500000001**
3. 观察页面：
   - ✅ 显示密码输入框
   - ✅ 有"使用验证码登录"选项
   - ✅ 可以在两种登录方式间切换

4. 输入密码：**abc1234**
5. 点击"登录"

### 预期结果
- 登录成功
- 跳转到主页（交易广场）
- 功能正常使用

## 测试4：普通用户无法访问后台

### 步骤
1. 使用普通账号登录（13500000001）
2. 直接访问：https://xxw86jrac1yl.space.minimaxi.com/admin

### 预期结果
- ✅ 弹出提示："抱歉，您没有权限访问此页面"
- ✅ 自动跳转回主页
- ✅ 无法访问任何管理员功能

## 测试5：未登录访问后台

### 步骤
1. 退出登录（如已登录）
2. 直接访问：https://xxw86jrac1yl.space.minimaxi.com/admin

### 预期结果
- ✅ 弹出提示："请先登录"
- ✅ 自动跳转到登录页面

## 短信服务说明

### spug短信平台
- **服务商**: https://push.spug.cc
- **发送方式**: 真实短信（非模拟）
- **验证码格式**: 6位数字
- **有效期**: 5分钟
- **发送限制**: 同一手机号1分钟内只能发送1次

### 验证码示例
```
【交易信息撮合平台】您的验证码是：123456，5分钟内有效。
```

## 常见问题

### Q: 收不到验证码？
A: 请检查：
1. 手机号是否输入正确
2. 手机是否能正常接收短信
3. 是否在1分钟内重复发送（有频率限制）
4. 查看垃圾短信箱

### Q: 验证码过期了？
A: 验证码有效期5分钟，过期后需要重新发送。

### Q: 管理员能否设置密码？
A: 不能。管理员账户的密码字段为NULL，系统禁止管理员设置或使用密码登录。

### Q: 如何添加新管理员？
A: 需要在数据库中执行SQL：
```sql
UPDATE users 
SET role = 'admin', is_admin = true, password = NULL 
WHERE phone = '新管理员手机号';
```

### Q: 如何取消管理员权限？
A: 在数据库中执行SQL：
```sql
UPDATE users 
SET role = 'user', is_admin = false 
WHERE phone = '手机号';
```

## 测试清单

请按顺序完成以下测试并打勾：

- [ ] 管理员手机号输入后自动切换到验证码登录
- [ ] 管理员界面显示专用提示
- [ ] 管理员无法看到密码登录选项
- [ ] 发送验证码，手机收到真实短信
- [ ] 输入验证码成功登录
- [ ] 登录后自动跳转到 /admin 后台
- [ ] 后台管理功能正常使用
- [ ] 普通用户可以使用密码登录
- [ ] 普通用户可以切换登录方式
- [ ] 普通用户访问后台被拒绝
- [ ] 未登录访问后台跳转到登录页

## 测试完成后

如果所有测试项都通过，说明系统运行正常。如有问题，请记录：
1. 测试步骤
2. 预期结果
3. 实际结果
4. 截图或错误信息

## 技术支持

如遇到问题，请提供：
- 测试的手机号
- 操作步骤
- 错误提示或截图
- 浏览器控制台错误信息（F12打开）
