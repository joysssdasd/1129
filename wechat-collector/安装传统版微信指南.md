# 安装传统版微信指南

## 为什么需要传统版微信？

你当前使用的是 **xwechat**（微信新架构版本），目前所有主流的微信自动化工具都不支持这个版本。

需要安装传统版 **WeChat 3.9.x** 才能使用自动采集功能。

## 下载地址

### 推荐版本：WeChat 3.9.11.25

**官方历史版本下载：**
- https://github.com/tom-snow/wechat-windows-versions/releases

**直接下载链接：**
- 3.9.11.25: https://github.com/tom-snow/wechat-windows-versions/releases/download/v3.9.11.25/WeChatSetup-3.9.11.25.exe

### 备用版本：WeChat 3.9.12.17
- https://github.com/tom-snow/wechat-windows-versions/releases/download/v3.9.12.17/WeChatSetup-3.9.12.17.exe

## 安装步骤

### 1. 卸载 xwechat

1. 打开 Windows 设置 → 应用 → 已安装的应用
2. 找到"微信"或"WeChat"，点击卸载
3. 删除残留数据（可选）：
   - `C:\Users\你的用户名\AppData\Roaming\Tencent\xwechat`

### 2. 安装传统版微信

1. 下载上面的安装包
2. 运行安装程序
3. **重要：安装时选择自定义安装路径**，建议安装到 `C:\Program Files\Tencent\WeChat`

### 3. 禁止自动更新

安装完成后，需要禁止微信自动更新到新版本：

**方法1：修改 hosts 文件**
1. 以管理员身份打开记事本
2. 打开文件 `C:\Windows\System32\drivers\etc\hosts`
3. 添加以下内容：
```
127.0.0.1 dldir1.qq.com
127.0.0.1 dldir1v6.qq.com
```
4. 保存文件

**方法2：设置文件夹只读**
1. 找到微信安装目录（如 `C:\Program Files\Tencent\WeChat`）
2. 右键 → 属性 → 勾选"只读"

### 4. 登录微信

1. 启动微信
2. 扫码登录
3. 确认版本号（设置 → 关于微信），应该显示 3.9.x.x

## 验证安装

安装完成后，运行以下命令验证：

```bash
cd wechat-collector
python -c "from wcferry import Wcf; wcf = Wcf(); print('连接成功:', wcf.is_login())"
```

如果显示"连接成功: True"，说明安装正确。

## 注意事项

1. **不要更新微信** - 新版本可能不兼容
2. **保持微信运行** - 自动采集需要微信在后台运行
3. **数据迁移** - 如果需要保留聊天记录，可以在卸载前备份 `D:\xwechat_files` 目录

## 常见问题

### Q: 安装后无法登录？
A: 可能是版本太旧，尝试 3.9.12.17 版本

### Q: 提示需要更新？
A: 按照上面的方法禁止自动更新

### Q: 聊天记录丢失？
A: xwechat 和传统版微信的数据不互通，需要重新同步聊天记录
