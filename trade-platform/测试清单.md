# 牛牛基地 - 测试清单

## 测试环境
- **生产URL**: https://da8q1o1p7yye.space.minimaxi.com
- **测试日期**: 2025-11-10
- **测试状态**: 进行中

## 核心业务流程测试

### 1. 用户注册登录流程 ⚠️

#### 1.1 用户注册
- [x] 访问登录页面
- [x] 切换到注册标签
- [x] 输入手机号（测试号：13900139888）
- [x] 输入微信号（测试号：test_user_888）
- [x] 点击发送验证码
- [ ] **待验证**：验证码是否成功发送
- [ ] **待验证**：输入验证码后能否成功注册
- [ ] **待验证**：注册成功后是否自动获得100积分
- [ ] **待验证**：是否正确跳转到首页

**已知问题**: 
- RLS策略问题已修复
- 需要重新测试完整注册流程

#### 1.2 用户登录
- [ ] 使用已注册账号登录
- [ ] 验证验证码发送
- [ ] 验证登录成功
- [ ] 验证积分显示正确

#### 1.3 管理员登录
- [ ] 使用管理员账号登录（13800138000）
- [ ] 验证管理后台入口显示
- [ ] 验证管理员权限正常

### 2. 交易信息发布流程 ⚠️

#### 2.1 发布新信息
- [ ] 登录后点击"发布"按钮
- [ ] 填写标题（测试：iPhone15转让）
- [ ] 填写关键词（测试：iPhone,手机,转让）
- [ ] 填写价格（测试：5800）
- [ ] 选择交易类型（测试：出售）
- [ ] 点击确认发布
- [ ] **待验证**：是否扣除10积分
- [ ] **待验证**：是否成功发布
- [ ] **待验证**：首页是否显示新发布的信息

#### 2.2 查看自己的发布
- [ ] 进入个人中心
- [ ] 点击"我的发布"
- [ ] 验证发布信息显示正确
- [ ] 验证状态为"上架中"
- [ ] 验证查看次数为0/10

### 3. 信息浏览和查看流程 ⚠️

#### 3.1 浏览信息列表
- [ ] 首页显示所有上架信息
- [ ] 搜索功能正常
- [ ] 筛选功能正常
- [ ] 点击信息进入详情页

#### 3.2 查看联系方式
- [ ] 进入信息详情页
- [ ] 点击"查看联系方式"按钮
- [ ] **待验证**：是否提示扣除1积分
- [ ] **待验证**：是否显示微信号
- [ ] **待验证**：是否自动复制到剪贴板
- [ ] **待验证**：积分是否正确扣除

#### 3.3 重复查看
- [ ] 再次查看同一信息
- [ ] **待验证**：是否免费查看
- [ ] **待验证**：是否不再扣除积分

### 4. 积分系统测试 ⚠️

#### 4.1 积分获取
- [x] 注册奖励（100积分）- 待验证
- [ ] 邀请奖励测试
  - [ ] 获取邀请码
  - [ ] 使用邀请码注册新用户
  - [ ] 新用户完成首次发布
  - [ ] 验证邀请人获得10积分
  - [ ] 验证被邀请人获得30积分

#### 4.2 积分消费
- [ ] 发布信息扣除10积分 - 待验证
- [ ] 查看联系方式扣除1积分 - 待验证

#### 4.3 积分流水
- [ ] 进入个人中心
- [ ] 查看积分明细
- [ ] 验证所有流水记录正确
- [ ] 验证余额计算正确

### 5. 充值系统测试 ⚠️

#### 5.1 充值申请
- [ ] 进入个人中心
- [ ] 点击充值积分
- [ ] 选择充值档位（测试：10元）
- [ ] 上传付款截图
- [ ] 提交充值申请
- [ ] **待验证**：申请是否成功创建

#### 5.2 充值审核（管理员）
- [ ] 管理员登录
- [ ] 进入管理后台
- [ ] 查看充值审核列表
- [ ] 查看付款截图
- [ ] 点击"通过"按钮
- [ ] **待验证**：用户积分是否到账
- [ ] **待验证**：积分流水是否记录

### 6. 管理后台功能测试 ⚠️

#### 6.1 用户管理
- [ ] 查看用户列表
- [ ] 禁用用户功能
- [ ] 启用用户功能
- [ ] 查看用户详细信息

#### 6.2 信息管理
- [ ] 查看交易信息列表
- [ ] 下架信息功能
- [ ] 验证下架后积分退还

#### 6.3 数据统计
- [ ] 查看总用户数
- [ ] 查看总信息数
- [ ] 查看待审核充值数

### 7. AI批量发布功能测试 ⚠️

#### 7.1 AI解析测试
- [ ] 管理员登录
- [ ] 进入AI批量发布页面
- [ ] 输入测试文本：
  ```
  成都周深 2 号邀请函代录 399的900 699的1000 包厢的1150 929的1250
  ```
- [ ] 点击"开始批量发布"
- [ ] **待验证**：AI是否正确解析
- [ ] **待验证**：是否生成多条信息
- [ ] **待验证**：信息是否成功发布到首页

### 8. 自动下架功能测试 ⚠️

#### 8.1 定时任务
- [ ] 创建测试信息（设置过期时间）
- [ ] 等待定时任务执行
- [ ] **待验证**：信息是否自动下架
- [ ] **待验证**：积分是否正确退还
- [ ] **待验证**：积分流水是否记录

### 9. 邀请系统测试 ⚠️

#### 9.1 邀请码分享
- [ ] 获取个人邀请码
- [ ] 复制邀请码功能
- [ ] 验证邀请码唯一性

#### 9.2 邀请奖励
- [ ] 新用户使用邀请码注册
- [ ] 新用户完成首次发布
- [ ] 验证邀请人获得10积分
- [ ] 验证被邀请人获得30积分
- [ ] 验证积分流水记录

## 非功能性测试

### 10. 响应式设计测试 ✅

- [x] 桌面端（1920x1080）
- [x] 平板端（768x1024）
- [ ] 移动端（375x667）
- [ ] 触控操作流畅性

### 11. 性能测试 ⚠️

- [ ] 首页加载时间 < 2秒
- [ ] API响应时间 < 100ms
- [ ] 图片加载优化
- [ ] 页面切换流畅度

### 12. 安全性测试 ⚠️

- [x] RLS策略配置 - 已完成
- [ ] SQL注入防护测试
- [ ] XSS攻击防护测试
- [ ] 验证码防刷测试
- [ ] 权限验证测试

## 测试总结

### 已完成测试
1. ✅ 首页重定向功能
2. ✅ 登录页面元素完整性
3. ✅ 验证码发送功能
4. ✅ RLS策略配置

### 待完成关键测试（优先级高）
1. ⚠️ **完整的用户注册流程**（最高优先级）
2. ⚠️ **交易信息发布功能**
3. ⚠️ **联系方式查看功能**
4. ⚠️ **充值申请和审核流程**
5. ⚠️ **AI批量发布功能**

### 待完成次要测试
6. ⚠️ 邀请系统完整流程
7. ⚠️ 自动下架定时任务
8. ⚠️ 管理后台所有功能
9. ⚠️ 性能测试
10. ⚠️ 安全测试

## 测试建议

### 手动测试步骤

#### 关键路径1：新用户注册和发布
1. 访问 https://da8q1o1p7yye.space.minimaxi.com
2. 注册新账号（使用真实手机号）
3. 验证100积分到账
4. 发布一条交易信息
5. 验证扣除10积分
6. 在首页查看自己的发布

#### 关键路径2：查看联系方式
1. 浏览其他用户的信息
2. 点击查看联系方式
3. 验证扣除1积分
4. 验证微信号显示
5. 再次查看验证不扣费

#### 关键路径3：充值流程
1. 进入个人中心
2. 点击充值积分
3. 选择档位上传截图
4. 管理员审核通过
5. 验证积分到账

#### 关键路径4：管理员功能
1. 使用管理员账号登录（13800138000）
2. 进入管理后台
3. 测试用户管理功能
4. 测试信息管理功能
5. 测试充值审核功能
6. 测试AI批量发布

### 自动化测试建议
建议后续开发自动化测试脚本，覆盖以上所有测试场景。

## 已知问题和修复记录

### 问题1: 注册API返回500错误
- **状态**: 已修复
- **原因**: RLS策略未配置
- **修复**: 添加了完整的RLS策略，允许anon和service_role访问
- **验证**: 待重新测试

### 问题2: 测试次数限制
- **状态**: 已知
- **说明**: 自动化测试工具有次数限制
- **建议**: 进行手动测试或申请继续测试

## 下一步行动

1. **立即行动**：重新测试修复后的注册功能
2. **优先测试**：完成所有关键业务流程测试
3. **记录问题**：发现问题立即记录并修复
4. **持续验证**：修复后重新测试受影响功能

---

**测试状态**: 🟡 部分完成，关键功能待验证
**建议**: 强烈建议完成所有关键路径测试后再正式上线
