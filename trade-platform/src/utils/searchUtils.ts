// 常用汉字拼音首字母映射（精简版，移除多音字重复）
const pinyinMap: { [key: string]: string } = {
  '阿': 'a', '啊': 'a', '哎': 'a', '唉': 'a', '爱': 'a', '安': 'a', '按': 'a', '案': 'a', '暗': 'a',
  '八': 'b', '把': 'b', '爸': 'b', '白': 'b', '百': 'b', '摆': 'b', '败': 'b', '班': 'b', '般': 'b', '板': 'b', '版': 'b', '办': 'b', '半': 'b', '帮': 'b', '包': 'b', '保': 'b', '报': 'b', '抱': 'b', '暴': 'b', '爆': 'b', '杯': 'b', '北': 'b', '备': 'b', '被': 'b', '背': 'b', '本': 'b', '笨': 'b', '比': 'b', '币': 'b', '必': 'b', '毕': 'b', '闭': 'b', '边': 'b', '编': 'b', '便': 'b', '遍': 'b', '变': 'b', '标': 'b', '表': 'b', '别': 'b', '宾': 'b', '冰': 'b', '兵': 'b', '病': 'b', '并': 'b', '补': 'b', '不': 'b', '布': 'b', '步': 'b', '部': 'b',
  '才': 'c', '材': 'c', '财': 'c', '采': 'c', '彩': 'c', '菜': 'c', '参': 'c', '餐': 'c', '残': 'c', '藏': 'c', '操': 'c', '草': 'c', '册': 'c', '测': 'c', '层': 'c', '曾': 'c', '插': 'c', '茶': 'c', '查': 'c', '差': 'c', '产': 'c', '长': 'c', '常': 'c', '场': 'c', '厂': 'c', '唱': 'c', '超': 'c', '朝': 'c', '潮': 'c', '炒': 'c', '车': 'c', '扯': 'c', '彻': 'c', '撤': 'c', '尘': 'c', '沉': 'c', '陈': 'c', '晨': 'c', '称': 'c', '成': 'c', '诚': 'c', '城': 'c', '程': 'c', '承': 'c', '乘': 'c', '吃': 'c', '池': 'c', '迟': 'c', '持': 'c', '尺': 'c', '充': 'c', '冲': 'c', '虫': 'c', '崇': 'c', '抽': 'c', '仇': 'c', '臭': 'c', '出': 'c', '初': 'c', '除': 'c', '处': 'c', '储': 'c', '触': 'c', '川': 'c', '穿': 'c', '传': 'c', '船': 'c', '串': 'c', '窗': 'c', '床': 'c', '创': 'c', '吹': 'c', '春': 'c', '纯': 'c', '词': 'c', '此': 'c', '次': 'c', '从': 'c', '丛': 'c', '粗': 'c', '促': 'c', '催': 'c', '存': 'c', '村': 'c', '错': 'c',
  '达': 'd', '答': 'd', '打': 'd', '大': 'd', '代': 'd', '带': 'd', '待': 'd', '袋': 'd', '贷': 'd', '单': 'd', '担': 'd', '胆': 'd', '但': 'd', '淡': 'd', '蛋': 'd', '弹': 'd', '当': 'd', '党': 'd', '挡': 'd', '刀': 'd', '导': 'd', '岛': 'd', '倒': 'd', '到': 'd', '道': 'd', '盗': 'd', '德': 'd', '的': 'd', '得': 'd', '灯': 'd', '等': 'd', '低': 'd', '底': 'd', '地': 'd', '第': 'd', '帝': 'd', '弟': 'd', '递': 'd', '典': 'd', '点': 'd', '电': 'd', '店': 'd', '掉': 'd', '爹': 'd', '跌': 'd', '叠': 'd', '顶': 'd', '订': 'd', '定': 'd', '丢': 'd', '东': 'd', '冬': 'd', '董': 'd', '懂': 'd', '动': 'd', '洞': 'd', '冻': 'd', '都': 'd', '抖': 'd', '斗': 'd', '豆': 'd', '毒': 'd', '独': 'd', '读': 'd', '堵': 'd', '赌': 'd', '度': 'd', '端': 'd', '短': 'd', '断': 'd', '段': 'd', '堆': 'd', '队': 'd', '对': 'd', '吨': 'd', '蹲': 'd', '顿': 'd', '多': 'd', '朵': 'd', '躲': 'd',
  '饿': 'e', '恶': 'e', '额': 'e', '儿': 'e', '而': 'e', '耳': 'e', '二': 'e',
  '发': 'f', '乏': 'f', '法': 'f', '翻': 'f', '凡': 'f', '烦': 'f', '繁': 'f', '反': 'f', '返': 'f', '犯': 'f', '饭': 'f', '范': 'f', '方': 'f', '房': 'f', '防': 'f', '访': 'f', '纺': 'f', '放': 'f', '飞': 'f', '非': 'f', '肥': 'f', '废': 'f', '费': 'f', '分': 'f', '芬': 'f', '纷': 'f', '坟': 'f', '粉': 'f', '份': 'f', '奋': 'f', '愤': 'f', '丰': 'f', '风': 'f', '封': 'f', '锋': 'f', '疯': 'f', '峰': 'f', '冯': 'f', '逢': 'f', '缝': 'f', '凤': 'f', '佛': 'f', '否': 'f', '夫': 'f', '肤': 'f', '伏': 'f', '扶': 'f', '服': 'f', '幅': 'f', '福': 'f', '抚': 'f', '府': 'f', '辅': 'f', '父': 'f', '付': 'f', '负': 'f', '妇': 'f', '附': 'f', '复': 'f', '副': 'f', '富': 'f', '腹': 'f',
  '该': 'g', '改': 'g', '概': 'g', '盖': 'g', '干': 'g', '甘': 'g', '杆': 'g', '肝': 'g', '赶': 'g', '敢': 'g', '感': 'g', '刚': 'g', '钢': 'g', '岗': 'g', '港': 'g', '高': 'g', '搞': 'g', '稿': 'g', '告': 'g', '哥': 'g', '歌': 'g', '革': 'g', '格': 'g', '隔': 'g', '个': 'g', '各': 'g', '给': 'g', '根': 'g', '跟': 'g', '更': 'g', '耕': 'g', '工': 'g', '公': 'g', '功': 'g', '攻': 'g', '供': 'g', '宫': 'g', '弓': 'g', '恭': 'g', '共': 'g', '贡': 'g', '勾': 'g', '沟': 'g', '钩': 'g', '狗': 'g', '构': 'g', '购': 'g', '够': 'g', '姑': 'g', '孤': 'g', '古': 'g', '股': 'g', '骨': 'g', '谷': 'g', '故': 'g', '顾': 'g', '固': 'g', '瓜': 'g', '刮': 'g', '挂': 'g', '乖': 'g', '怪': 'g', '关': 'g', '观': 'g', '官': 'g', '冠': 'g', '馆': 'g', '管': 'g', '贯': 'g', '惯': 'g', '灌': 'g', '罐': 'g', '光': 'g', '广': 'g', '逛': 'g', '规': 'g', '归': 'g', '龟': 'g', '鬼': 'g', '贵': 'g', '桂': 'g', '柜': 'g', '滚': 'g', '棍': 'g', '锅': 'g', '国': 'g', '果': 'g', '裹': 'g', '过': 'g',
  '哈': 'h', '还': 'h', '孩': 'h', '海': 'h', '害': 'h', '含': 'h', '寒': 'h', '喊': 'h', '汉': 'h', '汗': 'h', '旱': 'h', '行': 'h', '航': 'h', '毫': 'h', '豪': 'h', '好': 'h', '号': 'h', '耗': 'h', '喝': 'h', '合': 'h', '何': 'h', '和': 'h', '河': 'h', '核': 'h', '盒': 'h', '贺': 'h', '黑': 'h', '很': 'h', '恨': 'h', '横': 'h', '衡': 'h', '红': 'h', '洪': 'h', '宏': 'h', '虹': 'h', '哄': 'h', '后': 'h', '厚': 'h', '候': 'h', '呼': 'h', '忽': 'h', '狐': 'h', '胡': 'h', '湖': 'h', '糊': 'h', '虎': 'h', '互': 'h', '户': 'h', '护': 'h', '花': 'h', '华': 'h', '滑': 'h', '化': 'h', '划': 'h', '画': 'h', '话': 'h', '怀': 'h', '坏': 'h', '欢': 'h', '环': 'h', '换': 'h', '唤': 'h', '患': 'h', '荒': 'h', '皇': 'h', '黄': 'h', '煌': 'h', '晃': 'h', '灰': 'h', '挥': 'h', '辉': 'h', '回': 'h', '悔': 'h', '汇': 'h', '会': 'h', '绘': 'h', '惠': 'h', '毁': 'h', '婚': 'h', '魂': 'h', '混': 'h', '活': 'h', '火': 'h', '伙': 'h', '或': 'h', '货': 'h', '获': 'h', '祸': 'h', '惑': 'h',
  '击': 'j', '机': 'j', '鸡': 'j', '积': 'j', '基': 'j', '激': 'j', '及': 'j', '吉': 'j', '极': 'j', '即': 'j', '级': 'j', '急': 'j', '疾': 'j', '集': 'j', '籍': 'j', '几': 'j', '己': 'j', '挤': 'j', '脊': 'j', '计': 'j', '记': 'j', '纪': 'j', '技': 'j', '季': 'j', '剂': 'j', '济': 'j', '继': 'j', '寄': 'j', '加': 'j', '佳': 'j', '家': 'j', '嘉': 'j', '夹': 'j', '甲': 'j', '价': 'j', '假': 'j', '架': 'j', '驾': 'j', '嫁': 'j', '尖': 'j', '坚': 'j', '间': 'j', '肩': 'j', '艰': 'j', '监': 'j', '煎': 'j', '兼': 'j', '捡': 'j', '检': 'j', '减': 'j', '剪': 'j', '简': 'j', '建': 'j', '健': 'j', '舰': 'j', '渐': 'j', '践': 'j', '鉴': 'j', '键': 'j', '箭': 'j', '江': 'j', '姜': 'j', '将': 'j', '浆': 'j', '奖': 'j', '讲': 'j', '匠': 'j', '降': 'j', '酱': 'j', '交': 'j', '郊': 'j', '娇': 'j', '焦': 'j', '胶': 'j', '角': 'j', '脚': 'j', '搅': 'j', '叫': 'j', '教': 'j', '较': 'j', '接': 'j', '皆': 'j', '街': 'j', '阶': 'j', '节': 'j', '杰': 'j', '结': 'j', '姐': 'j', '解': 'j', '届': 'j', '介': 'j', '戒': 'j', '界': 'j', '借': 'j', '今': 'j', '金': 'j', '津': 'j', '斤': 'j', '仅': 'j', '紧': 'j', '锦': 'j', '尽': 'j', '近': 'j', '进': 'j', '晋': 'j', '浸': 'j', '禁': 'j', '京': 'j', '经': 'j', '精': 'j', '井': 'j', '景': 'j', '警': 'j', '径': 'j', '净': 'j', '竞': 'j', '竟': 'j', '敬': 'j', '静': 'j', '境': 'j', '镜': 'j', '纠': 'j', '究': 'j', '九': 'j', '久': 'j', '酒': 'j', '旧': 'j', '救': 'j', '就': 'j', '舅': 'j', '居': 'j', '局': 'j', '菊': 'j', '举': 'j', '矩': 'j', '句': 'j', '巨': 'j', '拒': 'j', '具': 'j', '俱': 'j', '剧': 'j', '据': 'j', '距': 'j', '聚': 'j', '卷': 'j', '绝': 'j', '决': 'j', '觉': 'j', '掘': 'j', '军': 'j', '君': 'j', '均': 'j',
  '卡': 'k', '开': 'k', '凯': 'k', '刊': 'k', '堪': 'k', '看': 'k', '砍': 'k', '康': 'k', '抗': 'k', '考': 'k', '烤': 'k', '靠': 'k', '科': 'k', '棵': 'k', '颗': 'k', '壳': 'k', '可': 'k', '渴': 'k', '克': 'k', '刻': 'k', '客': 'k', '课': 'k', '肯': 'k', '坑': 'k', '空': 'k', '孔': 'k', '恐': 'k', '控': 'k', '口': 'k', '扣': 'k', '枯': 'k', '哭': 'k', '苦': 'k', '库': 'k', '酷': 'k', '裤': 'k', '夸': 'k', '跨': 'k', '快': 'k', '块': 'k', '筷': 'k', '宽': 'k', '款': 'k', '狂': 'k', '况': 'k', '亏': 'k', '昆': 'k', '困': 'k', '扩': 'k', '括': 'k',
  '拉': 'l', '啦': 'l', '辣': 'l', '来': 'l', '赖': 'l', '兰': 'l', '拦': 'l', '蓝': 'l', '篮': 'l', '览': 'l', '懒': 'l', '烂': 'l', '滥': 'l', '狼': 'l', '郎': 'l', '朗': 'l', '浪': 'l', '捞': 'l', '劳': 'l', '牢': 'l', '老': 'l', '姥': 'l', '乐': 'l', '雷': 'l', '泪': 'l', '类': 'l', '累': 'l', '冷': 'l', '离': 'l', '梨': 'l', '礼': 'l', '李': 'l', '里': 'l', '理': 'l', '力': 'l', '历': 'l', '立': 'l', '丽': 'l', '利': 'l', '励': 'l', '例': 'l', '隶': 'l', '俩': 'l', '连': 'l', '联': 'l', '莲': 'l', '脸': 'l', '练': 'l', '炼': 'l', '链': 'l', '恋': 'l', '良': 'l', '凉': 'l', '梁': 'l', '粮': 'l', '两': 'l', '亮': 'l', '量': 'l', '辆': 'l', '谅': 'l', '疗': 'l', '聊': 'l', '料': 'l', '列': 'l', '劣': 'l', '烈': 'l', '猎': 'l', '裂': 'l', '邻': 'l', '林': 'l', '临': 'l', '淋': 'l', '灵': 'l', '铃': 'l', '零': 'l', '龄': 'l', '领': 'l', '令': 'l', '另': 'l', '溜': 'l', '留': 'l', '流': 'l', '柳': 'l', '六': 'l', '龙': 'l', '笼': 'l', '聋': 'l', '隆': 'l', '楼': 'l', '漏': 'l', '露': 'l', '炉': 'l', '卢': 'l', '鲁': 'l', '录': 'l', '陆': 'l', '路': 'l', '驴': 'l', '旅': 'l', '律': 'l', '率': 'l', '绿': 'l', '虑': 'l', '滤': 'l', '乱': 'l', '掠': 'l', '略': 'l', '轮': 'l', '论': 'l', '落': 'l', '罗': 'l', '萝': 'l', '逻': 'l', '骡': 'l', '裸': 'l',
  '妈': 'm', '麻': 'm', '马': 'm', '码': 'm', '吗': 'm', '骂': 'm', '埋': 'm', '买': 'm', '迈': 'm', '麦': 'm', '卖': 'm', '脉': 'm', '满': 'm', '蛮': 'm', '瞒': 'm', '慢': 'm', '漫': 'm', '忙': 'm', '芒': 'm', '盲': 'm', '茫': 'm', '猫': 'm', '毛': 'm', '矛': 'm', '茅': 'm', '冒': 'm', '帽': 'm', '贸': 'm', '貌': 'm', '么': 'm', '没': 'm', '眉': 'm', '梅': 'm', '媒': 'm', '煤': 'm', '每': 'm', '美': 'm', '妹': 'm', '门': 'm', '闷': 'm', '们': 'm', '萌': 'm', '猛': 'm', '孟': 'm', '梦': 'm', '迷': 'm', '谜': 'm', '米': 'm', '秘': 'm', '密': 'm', '蜜': 'm', '眠': 'm', '绵': 'm', '棉': 'm', '免': 'm', '勉': 'm', '面': 'm', '苗': 'm', '描': 'm', '秒': 'm', '妙': 'm', '庙': 'm', '灭': 'm', '民': 'm', '敏': 'm', '名': 'm', '明': 'm', '命': 'm', '摸': 'm', '模': 'm', '膜': 'm', '磨': 'm', '魔': 'm', '抹': 'm', '末': 'm', '莫': 'm', '墨': 'm', '默': 'm', '某': 'm', '母': 'm', '亩': 'm', '牧': 'm', '墓': 'm', '幕': 'm', '木': 'm', '目': 'm', '牡': 'm', '穆': 'm',
  '拿': 'n', '哪': 'n', '那': 'n', '纳': 'n', '娜': 'n', '乃': 'n', '奶': 'n', '耐': 'n', '南': 'n', '男': 'n', '难': 'n', '囊': 'n', '脑': 'n', '恼': 'n', '闹': 'n', '呢': 'n', '内': 'n', '嫩': 'n', '能': 'n', '尼': 'n', '泥': 'n', '你': 'n', '逆': 'n', '年': 'n', '念': 'n', '娘': 'n', '酿': 'n', '鸟': 'n', '尿': 'n', '捏': 'n', '您': 'n', '宁': 'n', '凝': 'n', '牛': 'n', '扭': 'n', '纽': 'n', '农': 'n', '浓': 'n', '弄': 'n', '奴': 'n', '努': 'n', '怒': 'n', '女': 'n', '暖': 'n', '诺': 'n', '挪': 'n',
  '哦': 'o', '欧': 'o', '偶': 'o',
  '怕': 'p', '拍': 'p', '排': 'p', '牌': 'p', '派': 'p', '攀': 'p', '盘': 'p', '判': 'p', '叛': 'p', '盼': 'p', '胖': 'p', '抛': 'p', '跑': 'p', '泡': 'p', '炮': 'p', '陪': 'p', '培': 'p', '赔': 'p', '佩': 'p', '配': 'p', '喷': 'p', '盆': 'p', '朋': 'p', '棚': 'p', '蓬': 'p', '捧': 'p', '碰': 'p', '批': 'p', '披': 'p', '皮': 'p', '疲': 'p', '脾': 'p', '匹': 'p', '屁': 'p', '偏': 'p', '片': 'p', '篇': 'p', '骗': 'p', '漂': 'p', '飘': 'p', '票': 'p', '撇': 'p', '拼': 'p', '贫': 'p', '频': 'p', '品': 'p', '聘': 'p', '平': 'p', '凭': 'p', '评': 'p', '苹': 'p', '瓶': 'p', '萍': 'p', '坡': 'p', '泼': 'p', '婆': 'p', '迫': 'p', '破': 'p', '魄': 'p', '剖': 'p', '扑': 'p', '铺': 'p', '葡': 'p', '朴': 'p', '浦': 'p', '普': 'p', '谱': 'p', '曝': 'p',
  '七': 'q', '妻': 'q', '凄': 'q', '期': 'q', '欺': 'q', '漆': 'q', '齐': 'q', '其': 'q', '奇': 'q', '骑': 'q', '棋': 'q', '旗': 'q', '乞': 'q', '企': 'q', '启': 'q', '起': 'q', '气': 'q', '弃': 'q', '汽': 'q', '契': 'q', '器': 'q', '恰': 'q', '洽': 'q', '千': 'q', '迁': 'q', '签': 'q', '牵': 'q', '铅': 'q', '谦': 'q', '前': 'q', '钱': 'q', '潜': 'q', '浅': 'q', '欠': 'q', '歉': 'q', '枪': 'q', '强': 'q', '墙': 'q', '抢': 'q', '悄': 'q', '敲': 'q', '桥': 'q', '瞧': 'q', '巧': 'q', '切': 'q', '茄': 'q', '且': 'q', '怯': 'q', '窃': 'q', '亲': 'q', '侵': 'q', '琴': 'q', '勤': 'q', '青': 'q', '轻': 'q', '氢': 'q', '倾': 'q', '清': 'q', '情': 'q', '晴': 'q', '请': 'q', '庆': 'q', '穷': 'q', '秋': 'q', '求': 'q', '球': 'q', '区': 'q', '曲': 'q', '驱': 'q', '屈': 'q', '躯': 'q', '趋': 'q', '渠': 'q', '取': 'q', '娶': 'q', '去': 'q', '趣': 'q', '圈': 'q', '全': 'q', '泉': 'q', '权': 'q', '拳': 'q', '犬': 'q', '劝': 'q', '券': 'q', '缺': 'q', '却': 'q', '确': 'q', '雀': 'q', '裙': 'q', '群': 'q',
  '然': 'r', '燃': 'r', '染': 'r', '嚷': 'r', '让': 'r', '饶': 'r', '绕': 'r', '惹': 'r', '热': 'r', '人': 'r', '仁': 'r', '忍': 'r', '认': 'r', '任': 'r', '韧': 'r', '扔': 'r', '仍': 'r', '日': 'r', '荣': 'r', '容': 'r', '溶': 'r', '融': 'r', '柔': 'r', '肉': 'r', '如': 'r', '儒': 'r', '乳': 'r', '入': 'r', '辱': 'r', '软': 'r', '瑞': 'r', '锐': 'r', '润': 'r', '若': 'r', '弱': 'r',
  '撒': 's', '洒': 's', '塞': 's', '赛': 's', '三': 's', '伞': 's', '散': 's', '桑': 's', '嗓': 's', '丧': 's', '扫': 's', '嫂': 's', '色': 's', '森': 's', '僧': 's', '杀': 's', '沙': 's', '砂': 's', '刹': 's', '纱': 's', '傻': 's', '啥': 's', '晒': 's', '山': 's', '杉': 's', '删': 's', '闪': 's', '陕': 's', '扇': 's', '善': 's', '伤': 's', '商': 's', '赏': 's', '上': 's', '尚': 's', '裳': 's', '稍': 's', '烧': 's', '少': 's', '绍': 's', '哨': 's', '奢': 's', '舌': 's', '蛇': 's', '舍': 's', '设': 's', '社': 's', '射': 's', '涉': 's', '摄': 's', '申': 's', '伸': 's', '身': 's', '深': 's', '神': 's', '审': 's', '婶': 's', '肾': 's', '甚': 's', '渗': 's', '升': 's', '生': 's', '声': 's', '牲': 's', '胜': 's', '绳': 's', '省': 's', '圣': 's', '盛': 's', '剩': 's', '尸': 's', '失': 's', '师': 's', '诗': 's', '施': 's', '狮': 's', '湿': 's', '十': 's', '什': 's', '石': 's', '时': 's', '识': 's', '实': 's', '拾': 's', '食': 's', '史': 's', '使': 's', '始': 's', '驶': 's', '士': 's', '氏': 's', '世': 's', '市': 's', '示': 's', '式': 's', '事': 's', '势': 's', '视': 's', '试': 's', '饰': 's', '室': 's', '是': 's', '适': 's', '逝': 's', '释': 's', '收': 's', '手': 's', '守': 's', '首': 's', '寿': 's', '受': 's', '授': 's', '售': 's', '瘦': 's', '兽': 's', '书': 's', '叔': 's', '舒': 's', '疏': 's', '输': 's', '蔬': 's', '熟': 's', '暑': 's', '署': 's', '属': 's', '鼠': 's', '薯': 's', '术': 's', '束': 's', '述': 's', '树': 's', '数': 's', '刷': 's', '耍': 's', '摔': 's', '甩': 's', '帅': 's', '双': 's', '霜': 's', '爽': 's', '水': 's', '睡': 's', '税': 's', '顺': 's', '说': 's', '硕': 's', '司': 's', '丝': 's', '私': 's', '思': 's', '斯': 's', '撕': 's', '死': 's', '四': 's', '寺': 's', '似': 's', '饲': 's', '松': 's', '宋': 's', '送': 's', '颂': 's', '搜': 's', '艘': 's', '苏': 's', '俗': 's', '诉': 's', '素': 's', '速': 's', '宿': 's', '塑': 's', '酸': 's', '蒜': 's', '算': 's', '虽': 's', '随': 's', '碎': 's', '岁': 's', '遂': 's', '隧': 's', '孙': 's', '损': 's', '笋': 's', '缩': 's', '所': 's', '索': 's', '锁': 's',
  '他': 't', '它': 't', '她': 't', '塔': 't', '踏': 't', '台': 't', '抬': 't', '太': 't', '态': 't', '泰': 't', '贪': 't', '摊': 't', '滩': 't', '坛': 't', '谈': 't', '潭': 't', '坦': 't', '叹': 't', '炭': 't', '探': 't', '汤': 't', '唐': 't', '堂': 't', '塘': 't', '糖': 't', '躺': 't', '趟': 't', '烫': 't', '逃': 't', '桃': 't', '淘': 't', '陶': 't', '讨': 't', '套': 't', '特': 't', '疼': 't', '腾': 't', '藤': 't', '梯': 't', '踢': 't', '提': 't', '题': 't', '体': 't', '替': 't', '天': 't', '添': 't', '田': 't', '甜': 't', '填': 't', '挑': 't', '条': 't', '调': 't', '跳': 't', '贴': 't', '铁': 't', '厅': 't', '听': 't', '廷': 't', '亭': 't', '庭': 't', '停': 't', '挺': 't', '艇': 't', '通': 't', '同': 't', '桐': 't', '铜': 't', '童': 't', '统': 't', '桶': 't', '痛': 't', '偷': 't', '头': 't', '投': 't', '透': 't', '突': 't', '图': 't', '徒': 't', '途': 't', '涂': 't', '土': 't', '吐': 't', '兔': 't', '团': 't', '推': 't', '腿': 't', '退': 't', '吞': 't', '屯': 't', '托': 't', '拖': 't', '脱': 't', '妥': 't', '拓': 't',
  '挖': 'w', '蛙': 'w', '娃': 'w', '瓦': 'w', '袜': 'w', '歪': 'w', '外': 'w', '弯': 'w', '湾': 'w', '丸': 'w', '完': 'w', '玩': 'w', '顽': 'w', '晚': 'w', '碗': 'w', '万': 'w', '汪': 'w', '王': 'w', '网': 'w', '往': 'w', '忘': 'w', '旺': 'w', '望': 'w', '危': 'w', '威': 'w', '微': 'w', '为': 'w', '围': 'w', '违': 'w', '唯': 'w', '维': 'w', '伟': 'w', '伪': 'w', '尾': 'w', '委': 'w', '卫': 'w', '未': 'w', '位': 'w', '味': 'w', '畏': 'w', '胃': 'w', '喂': 'w', '魏': 'w', '温': 'w', '文': 'w', '闻': 'w', '纹': 'w', '稳': 'w', '问': 'w', '翁': 'w', '窝': 'w', '我': 'w', '卧': 'w', '握': 'w', '污': 'w', '屋': 'w', '无': 'w', '吴': 'w', '五': 'w', '午': 'w', '伍': 'w', '武': 'w', '舞': 'w', '务': 'w', '物': 'w', '误': 'w', '悟': 'w', '雾': 'w',
  '西': 'x', '吸': 'x', '希': 'x', '析': 'x', '息': 'x', '牺': 'x', '悉': 'x', '惜': 'x', '稀': 'x', '溪': 'x', '锡': 'x', '熙': 'x', '膝': 'x', '习': 'x', '席': 'x', '袭': 'x', '喜': 'x', '戏': 'x', '系': 'x', '细': 'x', '隙': 'x', '虾': 'x', '瞎': 'x', '峡': 'x', '狭': 'x', '霞': 'x', '下': 'x', '吓': 'x', '夏': 'x', '厦': 'x', '仙': 'x', '先': 'x', '纤': 'x', '掀': 'x', '鲜': 'x', '闲': 'x', '弦': 'x', '贤': 'x', '咸': 'x', '嫌': 'x', '显': 'x', '险': 'x', '县': 'x', '现': 'x', '线': 'x', '限': 'x', '宪': 'x', '陷': 'x', '献': 'x', '乡': 'x', '相': 'x', '香': 'x', '箱': 'x', '湘': 'x', '详': 'x', '想': 'x', '响': 'x', '享': 'x', '项': 'x', '巷': 'x', '象': 'x', '像': 'x', '橡': 'x', '向': 'x', '削': 'x', '消': 'x', '宵': 'x', '销': 'x', '小': 'x', '晓': 'x', '孝': 'x', '效': 'x', '校': 'x', '笑': 'x', '些': 'x', '歇': 'x', '协': 'x', '斜': 'x', '携': 'x', '鞋': 'x', '写': 'x', '泄': 'x', '卸': 'x', '谢': 'x', '屑': 'x', '心': 'x', '辛': 'x', '欣': 'x', '新': 'x', '薪': 'x', '信': 'x', '兴': 'x', '星': 'x', '刑': 'x', '形': 'x', '型': 'x', '醒': 'x', '幸': 'x', '性': 'x', '姓': 'x', '凶': 'x', '兄': 'x', '胸': 'x', '雄': 'x', '熊': 'x', '休': 'x', '修': 'x', '羞': 'x', '朽': 'x', '秀': 'x', '绣': 'x', '袖': 'x', '虚': 'x', '需': 'x', '须': 'x', '徐': 'x', '许': 'x', '序': 'x', '叙': 'x', '绪': 'x', '续': 'x', '蓄': 'x', '宣': 'x', '玄': 'x', '悬': 'x', '旋': 'x', '选': 'x', '穴': 'x', '学': 'x', '雪': 'x', '血': 'x', '寻': 'x', '巡': 'x', '循': 'x', '训': 'x', '讯': 'x', '迅': 'x', '逊': 'x',
  '压': 'y', '呀': 'y', '鸦': 'y', '鸭': 'y', '牙': 'y', '芽': 'y', '雅': 'y', '亚': 'y', '咽': 'y', '烟': 'y', '淹': 'y', '盐': 'y', '严': 'y', '言': 'y', '岩': 'y', '炎': 'y', '沿': 'y', '研': 'y', '颜': 'y', '眼': 'y', '演': 'y', '掩': 'y', '厌': 'y', '艳': 'y', '宴': 'y', '验': 'y', '央': 'y', '殃': 'y', '扬': 'y', '羊': 'y', '阳': 'y', '杨': 'y', '洋': 'y', '仰': 'y', '养': 'y', '氧': 'y', '样': 'y', '腰': 'y', '邀': 'y', '摇': 'y', '遥': 'y', '咬': 'y', '药': 'y', '要': 'y', '耀': 'y', '爷': 'y', '野': 'y', '也': 'y', '页': 'y', '业': 'y', '叶': 'y', '夜': 'y', '液': 'y', '一': 'y', '伊': 'y', '衣': 'y', '医': 'y', '依': 'y', '仪': 'y', '宜': 'y', '姨': 'y', '遗': 'y', '移': 'y', '疑': 'y', '已': 'y', '以': 'y', '亿': 'y', '义': 'y', '艺': 'y', '忆': 'y', '议': 'y', '异': 'y', '役': 'y', '抑': 'y', '译': 'y', '易': 'y', '益': 'y', '意': 'y', '毅': 'y', '因': 'y', '阴': 'y', '音': 'y', '银': 'y', '引': 'y', '饮': 'y', '隐': 'y', '印': 'y', '应': 'y', '英': 'y', '樱': 'y', '鹰': 'y', '迎': 'y', '盈': 'y', '营': 'y', '赢': 'y', '影': 'y', '映': 'y', '硬': 'y', '拥': 'y', '永': 'y', '勇': 'y', '涌': 'y', '用': 'y', '优': 'y', '幽': 'y', '悠': 'y', '尤': 'y', '由': 'y', '邮': 'y', '油': 'y', '游': 'y', '友': 'y', '有': 'y', '又': 'y', '右': 'y', '幼': 'y', '诱': 'y', '于': 'y', '予': 'y', '余': 'y', '鱼': 'y', '愉': 'y', '渔': 'y', '娱': 'y', '雨': 'y', '与': 'y', '宇': 'y', '羽': 'y', '语': 'y', '玉': 'y', '育': 'y', '郁': 'y', '浴': 'y', '预': 'y', '域': 'y', '欲': 'y', '遇': 'y', '御': 'y', '裕': 'y', '元': 'y', '园': 'y', '原': 'y', '圆': 'y', '源': 'y', '缘': 'y', '远': 'y', '院': 'y', '愿': 'y', '怨': 'y', '约': 'y', '月': 'y', '越': 'y', '阅': 'y', '云': 'y', '允': 'y', '运': 'y', '韵': 'y', '孕': 'y',
  '扎': 'z', '杂': 'z', '灾': 'z', '栽': 'z', '载': 'z', '再': 'z', '在': 'z', '咱': 'z', '暂': 'z', '赞': 'z', '脏': 'z', '葬': 'z', '遭': 'z', '糟': 'z', '早': 'z', '枣': 'z', '澡': 'z', '灶': 'z', '造': 'z', '噪': 'z', '则': 'z', '择': 'z', '责': 'z', '贼': 'z', '怎': 'z', '曾': 'z', '增': 'z', '赠': 'z', '眨': 'z', '炸': 'z', '诈': 'z', '摘': 'z', '窄': 'z', '债': 'z', '沾': 'z', '粘': 'z', '展': 'z', '占': 'z', '战': 'z', '站': 'z', '张': 'z', '章': 'z', '涨': 'z', '掌': 'z', '丈': 'z', '仗': 'z', '帐': 'z', '账': 'z', '障': 'z', '招': 'z', '找': 'z', '召': 'z', '兆': 'z', '赵': 'z', '照': 'z', '罩': 'z', '遮': 'z', '折': 'z', '哲': 'z', '者': 'z', '这': 'z', '浙': 'z', '针': 'z', '珍': 'z', '真': 'z', '诊': 'z', '枕': 'z', '阵': 'z', '振': 'z', '镇': 'z', '震': 'z', '争': 'z', '征': 'z', '挣': 'z', '睁': 'z', '蒸': 'z', '整': 'z', '正': 'z', '证': 'z', '郑': 'z', '政': 'z', '症': 'z', '之': 'z', '支': 'z', '汁': 'z', '芝': 'z', '枝': 'z', '知': 'z', '织': 'z', '脂': 'z', '蜘': 'z', '执': 'z', '直': 'z', '值': 'z', '职': 'z', '植': 'z', '止': 'z', '址': 'z', '只': 'z', '旨': 'z', '纸': 'z', '指': 'z', '至': 'z', '志': 'z', '制': 'z', '治': 'z', '质': 'z', '致': 'z', '智': 'z', '置': 'z', '中': 'z', '忠': 'z', '终': 'z', '钟': 'z', '肿': 'z', '种': 'z', '众': 'z', '重': 'z', '州': 'z', '周': 'z', '洲': 'z', '粥': 'z', '轴': 'z', '宙': 'z', '皱': 'z', '骤': 'z', '朱': 'z', '珠': 'z', '株': 'z', '猪': 'z', '竹': 'z', '逐': 'z', '主': 'z', '煮': 'z', '嘱': 'z', '住': 'z', '助': 'z', '注': 'z', '驻': 'z', '柱': 'z', '祝': 'z', '著': 'z', '筑': 'z', '抓': 'z', '爪': 'z', '拽': 'z', '专': 'z', '砖': 'z', '转': 'z', '赚': 'z', '庄': 'z', '装': 'z', '壮': 'z', '状': 'z', '撞': 'z', '追': 'z', '坠': 'z', '准': 'z', '捉': 'z', '桌': 'z', '灼': 'z', '着': 'z', '仔': 'z', '兹': 'z', '资': 'z', '姿': 'z', '滋': 'z', '子': 'z', '紫': 'z', '字': 'z', '自': 'z', '宗': 'z', '综': 'z', '棕': 'z', '踪': 'z', '总': 'z', '纵': 'z', '走': 'z', '奏': 'z', '租': 'z', '足': 'z', '族': 'z', '阻': 'z', '组': 'z', '祖': 'z', '钻': 'z', '嘴': 'z', '最': 'z', '罪': 'z', '醉': 'z', '尊': 'z', '遵': 'z', '昨': 'z', '左': 'z', '作': 'z', '坐': 'z', '座': 'z', '做': 'z'
}

// 获取文字的拼音首字母
export function getPinyinInitial(char: string): string {
  if (/[a-zA-Z]/.test(char)) {
    return char.toLowerCase()
  }
  return pinyinMap[char] || ''
}

// 获取字符串的拼音首字母序列
export function getPinyinInitials(str: string): string {
  return str.split('').map(getPinyinInitial).join('')
}

// 模糊匹配函数 - 支持多种匹配模式
export function fuzzyMatch(text: string, query: string): { match: boolean; score: number } {
  if (!text || !query) return { match: false, score: 0 }
  
  const lowerText = text.toLowerCase()
  const lowerQuery = query.toLowerCase()
  
  // 1. 精确包含匹配 - 最高分
  if (lowerText.includes(lowerQuery)) {
    const startIndex = lowerText.indexOf(lowerQuery)
    return { match: true, score: startIndex === 0 ? 100 : 90 }
  }
  
  // 2. 拼音首字母匹配
  const textPinyin = getPinyinInitials(text)
  if (textPinyin.includes(lowerQuery)) {
    return { match: true, score: 80 }
  }
  
  // 3. 首字母开头匹配
  if (textPinyin.startsWith(lowerQuery)) {
    return { match: true, score: 85 }
  }
  
  // 4. 模糊字符匹配（允许跳过字符）
  let queryIndex = 0
  let consecutiveMatches = 0
  let maxConsecutive = 0
  
  for (let i = 0; i < lowerText.length && queryIndex < lowerQuery.length; i++) {
    if (lowerText[i] === lowerQuery[queryIndex]) {
      queryIndex++
      consecutiveMatches++
      maxConsecutive = Math.max(maxConsecutive, consecutiveMatches)
    } else {
      consecutiveMatches = 0
    }
  }
  
  if (queryIndex === lowerQuery.length) {
    const score = 50 + (maxConsecutive / lowerQuery.length) * 20
    return { match: true, score }
  }
  
  return { match: false, score: 0 }
}

// 搜索并排序结果
export function searchAndSort<T>(
  items: T[],
  query: string,
  getSearchFields: (item: T) => string[]
): T[] {
  if (!query.trim()) return items
  
  const results = items
    .map(item => {
      const fields = getSearchFields(item)
      let bestScore = 0
      
      for (const field of fields) {
        const { match, score } = fuzzyMatch(field, query)
        if (match && score > bestScore) {
          bestScore = score
        }
      }
      
      return { item, score: bestScore }
    })
    .filter(r => r.score > 0)
    .sort((a, b) => b.score - a.score)
  
  return results.map(r => r.item)
}

// 提取关键词并统计频率
export function extractKeywordStats(posts: { keywords: string }[]): { keyword: string; count: number }[] {
  const keywordCount = new Map<string, number>()
  
  posts.forEach(post => {
    if (!post.keywords) return
    
    const keywords = post.keywords.split(',').map(k => k.trim()).filter(Boolean)
    keywords.forEach(keyword => {
      const normalizedKeyword = keyword.toLowerCase()
      keywordCount.set(normalizedKeyword, (keywordCount.get(normalizedKeyword) || 0) + 1)
    })
  })
  
  return Array.from(keywordCount.entries())
    .map(([keyword, count]) => ({ keyword, count }))
    .sort((a, b) => b.count - a.count)
}

// 获取搜索建议
export function getSearchSuggestions(
  query: string,
  allKeywords: string[],
  limit: number = 8
): string[] {
  if (!query.trim()) return []
  
  const lowerQuery = query.toLowerCase()
  const suggestions: { keyword: string; score: number }[] = []
  
  for (const keyword of allKeywords) {
    const { match, score } = fuzzyMatch(keyword, lowerQuery)
    if (match) {
      suggestions.push({ keyword, score })
    }
  }
  
  return suggestions
    .sort((a, b) => b.score - a.score)
    .slice(0, limit)
    .map(s => s.keyword)
}

// 高亮匹配文本
export function highlightMatch(text: string, query: string): { text: string; highlight: boolean }[] {
  if (!query.trim()) return [{ text, highlight: false }]
  
  const lowerText = text.toLowerCase()
  const lowerQuery = query.toLowerCase()
  const result: { text: string; highlight: boolean }[] = []
  
  let lastIndex = 0
  let index = lowerText.indexOf(lowerQuery)
  
  while (index !== -1) {
    if (index > lastIndex) {
      result.push({ text: text.slice(lastIndex, index), highlight: false })
    }
    result.push({ text: text.slice(index, index + query.length), highlight: true })
    lastIndex = index + query.length
    index = lowerText.indexOf(lowerQuery, lastIndex)
  }
  
  if (lastIndex < text.length) {
    result.push({ text: text.slice(lastIndex), highlight: false })
  }
  
  return result.length > 0 ? result : [{ text, highlight: false }]
}
