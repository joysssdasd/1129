# 牛牛基地 - 使用指南

## 平台访问地址
**生产环境**: https://da8q1o1p7yye.space.minimaxi.com

## 系统概述

这是一个基于积分制度的C2C交易信息平台，用户可以发布和查看交易信息，通过积分系统实现信息的价值交换。

## 核心功能

### 1. 用户系统

#### 注册
1. 访问平台首页
2. 点击"注册"标签
3. 输入手机号（11位）
4. 输入微信号（6-20位，字母、数字、下划线、减号）
5. 可选：输入邀请码（6位大写字母和数字）
6. 点击"发送验证码"
7. 输入收到的6位验证码
8. 点击"注册"完成注册
9. **注册奖励**: 自动获得100积分

#### 登录
1. 访问平台首页
2. 点击"登录"标签
3. 输入手机号
4. 点击"发送验证码"
5. 输入验证码
6. 点击"登录"

### 2. 交易信息发布

#### 发布流程
1. 登录后点击底部"发布"按钮
2. 填写以下信息：
   - **标题**（必填，最多30字）
   - **关键词**（必填，3-5个，用英文逗号分隔）
   - **价格**（必填，数字）
   - **交易类型**（必填，选择：求购/出售/做多/做空）
   - **交割时间**（做多/做空时必填）
   - **补充信息**（做多/做空时必填，最多20字）
3. 确认信息无误后点击"确认发布"
4. **扣除10积分**，获得10次联系方式查看机会
5. 信息自动上架，**72小时后自动下架**

#### 关键点
- 发布需要10积分
- 每条信息有10次查看机会
- 查看完或72小时后自动下架
- 下架时退还剩余查看次数对应的积分

### 3. 浏览和查看交易信息

#### 浏览信息
1. 在首页可以看到所有上架的交易信息
2. 使用搜索栏搜索关键词
3. 使用分类筛选（全部/求购/出售/做多/做空）
4. 点击信息卡片查看详情

#### 查看联系方式
1. 进入信息详情页
2. 点击底部"查看联系方式"按钮
3. **支付1积分**
4. 系统自动复制发布者微信号到剪贴板
5. 已查看过的信息可免费再次查看

### 4. 积分系统

#### 积分获取方式
| 途径 | 积分数量 | 说明 |
|------|---------|------|
| 注册奖励 | +100 | 首次注册成功 |
| 邀请奖励（邀请人） | +10 | 被邀请人完成首次发布 |
| 被邀请奖励 | +30 | 完成首次发布 |
| 充值 | 按档位 | 通过充值获得 |
| 下架退还 | +剩余次数 | 信息下架时退还 |

#### 积分消费方式
| 场景 | 积分数量 | 说明 |
|------|---------|------|
| 发布信息 | -10 | 获得10次查看机会 |
| 查看联系方式 | -1 | 单次查看费用 |

#### 充值档位
| 金额 | 积分 | 折扣 |
|------|------|------|
| 10元 | 100积分 | 无 |
| 50元 | 550积分 | 9折 |
| 100元 | 1200积分 | 8折 |
| 200元 | 2600积分 | 6.5折 |

### 5. 充值流程

1. 登录后进入"个人中心"
2. 点击"充值积分"
3. 选择充值档位
4. 联系管理员获取收款二维码
5. 扫码支付并上传付款截图
6. 点击"提交充值申请"
7. 等待管理员审核
8. 审核通过后积分自动到账

### 6. 个人中心

#### 功能模块
- **积分余额**：查看当前可用积分
- **成交率**：个人成交率统计
- **邀请码**：分享邀请码邀请好友
- **我的发布**：管理已发布的信息
- **查看历史**：查看已付费查看的信息记录
- **积分明细**：查看所有积分变动记录

## 管理员功能

### 访问后台
1. 使用管理员账号登录（手机号：13800138000）
2. 首页右上角点击"管理"按钮
3. 进入管理后台

### 后台功能

#### 1. 用户管理
- 查看所有用户列表
- 禁用/启用用户
- 查看用户详细信息（积分、发布数、成交率）

#### 2. 信息管理
- 查看所有交易信息
- 下架违规或过期信息
- 批量管理信息

#### 3. 充值审核
- 查看所有充值申请
- 查看付款截图
- 通过/拒绝充值申请
- 通过后积分自动到账

#### 4. AI批量发布
1. 点击"AI批量发布"标签
2. 在文本框输入交易描述
   ```
   例如：成都周深 2 号邀请函代录 399的900 699的1000 包厢的1150 929的1250
   ```
3. 点击"开始批量发布"
4. AI自动解析并生成多条交易信息
5. 信息自动发布到牛牛基地

## 技术架构

### 前端技术栈
- **React 18.3** + **TypeScript**
- **Vite 6.0** 构建工具
- **TailwindCSS** UI框架
- **React Router** 路由管理
- **Lucide React** 图标库

### 后端技术栈
- **Supabase** 数据库和后端服务
- **Edge Functions** 服务端逻辑
- **PostgreSQL** 数据存储
- **Supabase Storage** 文件存储

### 核心功能实现

#### 1. 数据库表（9张）
- users - 用户表
- posts - 交易信息表
- point_transactions - 积分流水表
- recharge_requests - 充值申请表
- admin_settings - 管理员设置表
- view_history - 查看历史表
- invitations - 邀请记录表
- verification_codes - 验证码表
- announcements - 系统公告表

#### 2. 边缘函数（9个）
- send-verification-code - 发送验证码（集成spug短信API）
- auth-register - 用户注册
- auth-login - 用户登录
- publish-post - 发布交易信息
- view-contact - 查看联系方式
- recharge-request - 充值申请
- admin-approve-recharge - 管理员审核充值
- ai-batch-publish - AI批量发布（DeepSeek API）
- auto-expire-posts - 自动下架（定时任务，每小时执行）

#### 3. AI功能集成
- **DeepSeek API**: 智能解析交易描述文本
- 自动生成标题、价格、关键词
- 批量创建交易信息
- 提升运营效率

#### 4. 短信服务
- **spug平台短信服务**
- 发送验证码
- 支持中国大陆手机号

## 默认测试账户

### 管理员账户
- 手机号：13800138000
- 微信号：admin_wechat
- 邀请码：ADMIN1
- 初始积分：10000
- 权限：完整管理后台权限

### 测试用户
- 手机号：13900139000
- 微信号：test_user
- 邀请码：TEST01
- 初始积分：500

## 注意事项

### 用户须知
1. 手机号和微信号一旦注册不可修改
2. 邀请码只能在注册时填写
3. 发布信息前确保积分充足（至少10积分）
4. 查看联系方式需要消耗1积分
5. 已查看过的信息可免费再次查看
6. 信息72小时后自动下架，剩余积分会退还

### 管理员须知
1. 充值审核要仔细核对付款截图
2. AI批量发布以管理员身份发布，不扣除积分
3. 定时任务每小时自动执行一次过期信息下架
4. 禁用用户前请慎重考虑

### 安全提示
1. 验证码5分钟内有效
2. 1小时内最多发送3次验证码
3. 注意保护个人账户信息
4. 牛牛基地仅提供信息撮合服务，不承担交易责任

## 常见问题

### Q1: 注册后没有收到100积分？
**A**: 注册成功后会自动到账100积分，请检查个人中心的积分余额。

### Q2: 发布信息失败提示积分不足？
**A**: 发布信息需要10积分，请先充值获得足够积分。

### Q3: 查看过的联系方式还要再付费吗？
**A**: 不需要，已查看过的信息可以免费再次查看联系方式。

### Q4: 充值多久能到账？
**A**: 提交充值申请后，管理员审核通过即可到账，一般在24小时内处理。

### Q5: 邀请好友有什么奖励？
**A**: 好友使用你的邀请码注册并完成首次发布后，你可获得10积分，好友获得30积分。

### Q6: 信息发布后可以修改吗？
**A**: 目前不支持修改，只能下架后重新发布（需要重新扣除10积分）。

### Q7: 如何提高成交率？
**A**: 成交率 = 成交数 / 总发布数。用户查看你的联系方式后24小时会收到成交确认提示。

## 技术支持

如有问题或建议，请联系管理员。

## 版本信息

- **版本**: V1.0
- **发布日期**: 2025-11-10
- **最后更新**: 2025-11-10
