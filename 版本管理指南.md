# 🔄 版本管理与回滚指南

## 一、查看历史版本

```bash
cd E:\claude15

# 查看最近10次提交记录
git log --oneline -10

# 查看更详细的提交记录
git log --oneline -20
```

输出示例：
```
9194442 用户管理增加搜索和排行功能
abc1234 修复充值审批重复操作问题
def5678 修复充值功能：添加缺失的payment_method字段
...
```

## 二、回滚到指定版本

### 方法1：软回滚（推荐，保留修改历史）

```bash
# 回滚到指定版本，会创建一个新的提交
git revert <commit_id>

# 例如回滚最近一次提交
git revert HEAD

# 推送到远程
git push
```

### 方法2：硬回滚（彻底回退，删除之后的提交）

```bash
# 回退到指定版本（本地）
git reset --hard <commit_id>

# 强制推送到远程（⚠️ 谨慎使用）
git push --force
```

## 三、常用场景

### 场景1：最新版本有bug，回滚到上一个版本

```bash
cd E:\claude15

# 查看提交记录，找到上一个稳定版本
git log --oneline -5

# 假设上一个稳定版本是 abc1234
git revert HEAD
git push

# 然后去 EdgeOne 重新部署
```

### 场景2：回滚到特定功能之前

```bash
# 查看历史，找到目标版本
git log --oneline -20

# 假设要回到 def5678 这个版本
git reset --hard def5678
git push --force

# 然后去 EdgeOne 重新部署
```

### 场景3：只是想看看旧版本代码（不修改）

```bash
# 临时切换到旧版本查看
git checkout <commit_id>

# 看完后切回最新版本
git checkout main
```

## 四、EdgeOne 部署回滚

1. 登录 EdgeOne 控制台
2. 进入你的项目
3. 找到"部署记录"或"版本管理"
4. 选择之前的稳定版本，点击"回滚"

## 五、重要版本标记（可选）

给重要的稳定版本打标签，方便以后找：

```bash
# 给当前版本打标签
git tag v1.0-stable

# 给历史版本打标签
git tag v0.9-stable abc1234

# 推送标签到远程
git push --tags

# 以后可以直接回滚到标签
git reset --hard v1.0-stable
```

## 六、快速命令速查

| 操作 | 命令 |
|------|------|
| 查看历史 | `git log --oneline -10` |
| 回滚最近一次 | `git revert HEAD && git push` |
| 硬回滚到指定版本 | `git reset --hard <id> && git push --force` |
| 查看当前版本 | `git log -1` |
| 打标签 | `git tag v1.0-stable` |

---

**记住：** 每次重大功能上线前，先记下当前的 commit id，万一有问题可以快速回滚！
